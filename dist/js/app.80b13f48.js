(function(e){function t(t){for(var i,r,c=t[0],s=t[1],l=t[2],u=0,f=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);d&&d(t);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(i=!1)}i&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},o={app:0},a=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=s;a.push([8,"chunk-vendors"]),n()})({0:function(e,t){},"034f":function(e,t,n){"use strict";n("85ec")},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},6:function(e,t){},7:function(e,t){},7156:function(e,t,n){},8:function(e,t,n){e.exports=n("cd49")},"85ec":function(e,t,n){},"8cd0":function(e,t,n){"use strict";n("e86d")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("0cdd");var i=n("2b0e"),o=n("5f5b");n("ab8b"),n("2dd8");i["default"].use(o["a"]);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h2",{staticClass:"text-left pl-3 mb-3 mt-1"},[e._v(" 音声翻訳webシステム ")]),n("router-view")],1)},r=[],c=(n("034f"),n("2877")),s={},l=Object(c["a"])(s,a,r,!1,null,null,null),d=l.exports,u=n("8c4f"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{staticClass:"experiments",attrs:{fluid:""}},[n("b-row",{attrs:{"align-h":"between"}},[n("b-col",{staticClass:"text-left"},[n("a",{attrs:{id:"download"}}),n("b-button",{staticClass:"ml-3",attrs:{variant:"primary"},on:{click:e.resetData}},[e._v("リセット")])],1),n("b-col",[n("div",{staticClass:"text-right"},[e._v(e._s(e.startTime))]),n("div",{staticClass:"text-right"},[e._v("経過時間："+e._s(e.elapsedTime))])])],1),n("b-table",{attrs:{"sticky-header":"78vh","no-border-collapse":"",fixed:"",fields:e.tableFields,items:e.audioItems},scopedSlots:e._u([{key:"cell(jaText)",fn:function(t){return[t.item.localflg?n("div",[n("div",{staticClass:"float-right",staticStyle:{"margin-left":"60%"}},[e._v(e._s(t.value))])]):n("div",[n("div",{staticClass:"float-left",staticStyle:{"margin-right":"60%"}},[e._v(e._s(t.value))])])]}},{key:"cell(localflg)",fn:function(t){return[t.item.localflg?n("div",[n("div",{staticClass:"local-device"},[e._v(e._s(t.value))])]):n("div",[n("div",{staticClass:"receive-device"},[e._v(e._s(t.value))])])]}}])})],1)},h=[],v=(n("c975"),n("baa5"),n("d81d"),n("fb6a"),n("c19f"),n("d3b7"),n("25f0"),n("3ca3"),n("38cf"),n("cfc3"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("ddb0"),n("2b3d"),n("743c")),m=n("2d28"),g=n("8d7f"),p=n("8264"),w=n("bc3a"),b=n.n(w),y=n("11c1"),A="55bb3e290b3d4405abdc1e3cae706eab",x=v["a"].fromSubscription(A,"japaneast");x.speechRecognitionLanguage="ja-jp";var S,T,I,R,M,C,_="d145a64af1614123a0cadb03589d4766",D="https://api.cognitive.microsofttranslator.com/",j="japaneast",O=[],k=[],U=4096,W=16e3;function L(e){return e>Math.pow(10,1)?String(e):("00"+e).slice(-2)}var z={name:"Experiments",components:{},props:[],data:function(){return{tableFields:[{key:"localflg",label:"デバイス",thStyle:"width: 10%;",formatter:function(e){return e?"マイク":"スピーカー"}},{key:"stTime",label:"時間",thStyle:"width: 10%;",formatter:function(e){return L(e.getHours())+":"+L(e.getMinutes())+":"+L(e.getSeconds())}},{key:"jaText",label:"本文",thStyle:"width: 50%;"},{key:"enText",label:"翻訳",thStyle:"width: 30%;"}],audioItems:[],localAudioWriting:!1,recieveAudioWriting:!1,vcmdMode:!1}},computed:{startTime:function(){var e=new Date;return this.audioItems.length>0&&(e=this.audioItems[0].stTime),e.getFullYear()+"/"+L(e.getMonth()+1)+"/"+L(e.getDate())},elapsedTime:function(){var e="00:00:00";if(this.audioItems.length>0){var t=this.audioItems[0].stTime,n=new Date,i=n.getTime()-t.getTime(),o=Math.floor(i/36e5),a=Math.floor(i/6e4-60*o),r=Math.floor(i/1e3-60*o*60-60*a);e=L(o)+":"+L(a)+":"+L(r)}return e}},mounted:function(){this.connectLocalAudio(),this.connectRecieveAudio();var e=this;window.addEventListener("keydown",(function(t){t.repeat||"Insert"!==t.key||(e.vcmdMode=!0)})),window.addEventListener("keyup",(function(t){"Insert"===t.key&&(e.vcmdMode=!1)}))},destroyed:function(){this.disconectDevice()},methods:{resetData:function(){this.audioItems=[],this.localAudioWriting=!1,this.recieveAudioWriting=!1,this.vcmdMode=!1},disconectDevice:function(){S&&S.disconnect(),T&&T.disconnect(),I&&I.stopContinuousRecognitionAsync(),R&&R.stopContinuousRecognitionAsync(),M&&M.disconnect(),C&&C.disconnect()},writeText:function(e,t){if(t)if(this.localAudioWriting){var n=this.audioItems.map((function(e){return e.localflg})).lastIndexOf(t);this.audioItems[n].jaText=e}else this.audioItems.push({jaText:e,enText:"",localflg:t,stTime:new Date,finTime:null}),this.localAudioWriting=!0;else if(this.recieveAudioWriting){var i=this.audioItems.map((function(e){return e.localflg})).lastIndexOf(t);this.audioItems[i].jaText=e}else this.audioItems.push({jaText:e,enText:"",localflg:t,stTime:new Date,finTime:null}),this.recieveAudioWriting=!0},confirmText:function(e,t){var n=this.audioItems.map((function(e){return e.localflg})).lastIndexOf(t);this.audioItems[n].jaText=e,this.audioItems[n].finTime=new Date,this.translator(e,n),t?this.localAudioWriting=!1:this.recieveAudioWriting=!1,this.scroll()},connectLocalAudio:function(){var e=this,t={audio:!0,video:!1};navigator.mediaDevices.getUserMedia(t).then((function(t){var n=m["a"].fromStreamInput(t);I=new g["a"](x,n),e.setRecognizerOption(I,!0),I.startContinuousRecognitionAsync()})).catch((function(e){console.error("mediaDevice.getUserMedia() error:",e)}))},connectRecieveAudio:function(){var e=this,t={audio:!0,video:!0};navigator.mediaDevices.getDisplayMedia(t).then((function(t){var n=m["a"].fromStreamInput(t);R=new g["a"](x,n),e.setRecognizerOption(R,!1),R.startContinuousRecognitionAsync()})).catch((function(t){console.error("mediaDevice.getUserMedia() error:",t),alert("音声共有を許可した上で、全画面共有してください"),e.connectRecieveAudio()}))},translator:function(e,t){var n=this;b()({baseURL:D,url:"/translate",method:"post",headers:{"Ocp-Apim-Subscription-Key":_,"Ocp-Apim-Subscription-Region":j,"Content-type":"application/json","X-ClientTraceId":Object(y["v4"])().toString()},params:{"api-version":"3.0",from:"ja",to:"en"},data:[{text:e}],responseType:"json"}).then((function(e){var i=e.data[0].translations[0].text;n.audioItems[t]&&(n.audioItems[t].enText=i)}))},startRecording:function(e){O=[];var t=new AudioContext({sampleRate:W}),n=t.createScriptProcessor(U,1,1);M=t.createMediaStreamSource(e),M.connect(n),n.onaudioprocess=function(e){0==O.length&&new Date;for(var t=e.inputBuffer.getChannelData(0),n=new Float32Array(U),i=0;i<U;i++)n[i]=t[i];O.push(n)},n.connect(t.destination)},startRecordingRecieve:function(e){k=[];var t=new AudioContext({sampleRate:W}),n=t.createScriptProcessor(U,1,1);C=t.createMediaStreamSource(e),C.connect(n),n.onaudioprocess=function(e){0==O.length&&new Date;for(var t=e.inputBuffer.getChannelData(0),n=new Float32Array(U),i=0;i<U;i++)n[i]=t[i];k.push(n)},n.connect(t.destination)},downloadRecording:function(){var e=document.getElementById("download"),t=this.createWAV(O),n=window.URL||window.webkitURL;e.href=n.createObjectURL(t),e.download="localAuio.wav",e.click()},createWAV:function(e,t,n){var i=this.cutSamples(this.mergeBuffers(e),t,n),o=this.encodeWAV(i,W),a=new Blob([o],{type:"audio/wav"});return a},drawWave:function(e,t,n){var i=t.getContext("2d"),o=new AudioContext,a=o.createAnalyser();function r(){if(i){var e=t.width/a.fftSize,n=new Uint8Array(a.fftSize);a.getByteTimeDomainData(n),i.fillStyle="rgba(0, 0, 0, 1)",i.fillRect(0,0,t.width,t.height);for(var o=0;o<a.fftSize;++o){var c=n[o],s=c/255,l=t.height*s,d=t.height-l;i.fillStyle="lime",i.fillRect(o*e,d,e,2)}requestAnimationFrame(r)}}a.fftSize=2048,n?(S=o.createMediaStreamSource(e),S.connect(a)):(T=o.createMediaStreamSource(e),T.connect(a)),r()},setRecognizerOption:function(e,t){var n=this;e.recognizing=function(e,i){n.writeText(i.result.text,t)},e.recognized=function(e,i){i.result.reason==p["a"].RecognizedSpeech?(n.confirmText(i.result.text,t),n.vcmdMode&&(console.log("コマンド:"+i.result.text),i.result.text.indexOf("開発")>-1&&(window.location.href="/dev"))):i.result.reason==p["a"].NoMatch&&console.log("NOMATCH: Speech could not be recognized.")},e.canceled=function(t,n){console.log("CANCELED: Reason=".concat(n.reason)),e.stopContinuousRecognitionAsync()},e.sessionStopped=function(t,n){console.log("\n    Session stopped event."),e.stopContinuousRecognitionAsync()}},encodeWAV:function(e,t){var n=new ArrayBuffer(44+2*e.length),i=new DataView(n),o=function(e,t,n){for(var i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))},a=function(e,t,n){for(var i=0;i<n.length;i++,t+=2){var o=Math.max(-1,Math.min(1,n[i]));e.setInt16(t,o<0?32768*o:32767*o,!0)}};return o(i,0,"RIFF"),i.setUint32(4,32+2*e.length,!0),o(i,8,"WAVE"),o(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,1,!0),i.setUint32(24,t,!0),i.setUint32(28,2*t,!0),i.setUint16(32,2,!0),i.setUint16(34,16,!0),o(i,36,"data"),i.setUint32(40,2*e.length,!0),a(i,44,e),i},mergeBuffers:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].length;for(var i=new Float32Array(t),o=0,a=0;a<e.length;a++)for(var r=0;r<e[a].length;r++)i[o]=e[a][r],o++;return i},cutSamples:function(e,t,n){if(!t||!n)return e;var i=0;t=t-i>0?t-i:0,n=n-i>0?n-i:n-t;var o=t*W,a=n*W,r=e.slice(o,a);if(0==r.length)throw"Error: samples lengh is 0";if(r.length<=4*W){var c=Math.ceil(10*W/r.length),s=r;r=new Float32Array(s.length*c);for(var l=0;l<c;l++)r.set(s,s.length*l)}else r.length>=120*W&&(r=r.slice(0,120*W));return r},scroll:function(){var e=this.$el.querySelector(".b-table-sticky-header");e.scrollTop=e.scrollHeight}}},E=z,F=(n("8cd0"),Object(c["a"])(E,f,h,!1,null,"3fbf34f0",null)),B=F.exports,P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{staticClass:"dev",attrs:{fluid:""}},[n("b-row",{attrs:{"align-h":"between"}},[n("b-col",{attrs:{cols:"2"}},[n("div",[e._v("開発用")]),e.vcmdMode?n("b-icon",{attrs:{icon:"code-slash",variant:"danger"}}):e._e(),e.vcmdMode?n("b-icon",{attrs:{icon:"tools",variant:"danger"}}):e._e()],1),n("b-col",{staticClass:"text-left",attrs:{cols:"3"}},[e.vcmd?n("div",[e._v("コマンド："+e._s(e.vcmd))]):e._e(),e.vcmdMsg?n("div",{staticClass:"text-danger"},[e._v(e._s(e.vcmdMsg))]):e._e()]),n("b-col",{staticClass:"text-left"},[n("a",{attrs:{id:"download"}})]),n("b-col",[n("div",{staticClass:"text-right"},[e._v("正答率："+e._s(e.correctRatio)+"%")])]),n("b-col",[n("div",{staticClass:"text-right"},[e._v(e._s(e.startTime))]),n("div",{staticClass:"text-right"},[e._v("経過時間："+e._s(e.elapsedTime))])])],1),n("b-table",{attrs:{"sticky-header":"78vh","no-border-collapse":"",fixed:"",selectable:"","select-mode":"single",fields:e.tableFields,items:e.audioItems},on:{"row-selected":e.onRowSelected},scopedSlots:e._u([{key:"cell(jaText)",fn:function(t){return[t.item.localflg?n("div",[n("div",{staticClass:"float-right",staticStyle:{"margin-left":"60%"}},[e._v(e._s(t.value))])]):n("div",[n("div",{staticClass:"float-left",staticStyle:{"margin-right":"60%"}},[e._v(e._s(t.value))])])]}},{key:"cell(localflg)",fn:function(t){return[t.item.localflg?n("div",[n("div",{staticClass:"local-device"},[e._v(e._s(t.value))])]):n("div",[n("div",{staticClass:"receive-device"},[e._v(e._s(t.value))])])]}},{key:"cell(correctflg)",fn:function(t){return[n("b-form-group",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.item.correctflg,expression:"data.item.correctflg"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.item.correctflg)?e._i(t.item.correctflg,null)>-1:t.item.correctflg},on:{change:function(n){var i=t.item.correctflg,o=n.target,a=!!o.checked;if(Array.isArray(i)){var r=null,c=e._i(i,r);o.checked?c<0&&e.$set(t.item,"correctflg",i.concat([r])):c>-1&&e.$set(t.item,"correctflg",i.slice(0,c).concat(i.slice(c+1)))}else e.$set(t.item,"correctflg",a)}}})])]}}])})],1)},V=[],$=(n("4de4"),n("4160"),n("a15b"),n("b64b"),n("159b"),n("b85c")),N="55bb3e290b3d4405abdc1e3cae706eab",H=v["a"].fromSubscription(N,"japaneast");H.speechRecognitionLanguage="en-us";var q,J,K,X,Y,G,Q,Z,ee,te="eb87360816204677a17423ccef781f8c",ne="https://api.cognitive.microsofttranslator.com/",ie="japaneast",oe=[],ae=[],re=4096,ce=16e3,se="127.0.0.1:8000";function le(e){return e>Math.pow(10,1)?String(e):("00"+e).slice(-2)}var de={name:"dev",components:{},props:[],data:function(){return{tableFields:[{key:"localflg",label:"デバイス",thStyle:"width: 10%;",formatter:function(e){return e?"マイク":"スピーカー"}},{key:"stTime",label:"時間",thStyle:"width: 10%;",formatter:function(e){return le(e.getHours())+":"+le(e.getMinutes())+":"+le(e.getSeconds())}},{key:"jaText",label:"本文",thStyle:"width: 50%;"},{key:"enText",label:"翻訳",thStyle:"width: 30%;"},{key:"correctflg",label:"正答",thStyle:"width: 8%;"}],audioItems:[],selectedAudioItems:[],localAudioWriting:!1,recieveAudioWriting:!1,vcmdMode:!1,vcmd:"",vcmdMsg:""}},computed:{startTime:function(){var e=new Date;return this.audioItems.length>0&&(e=this.audioItems[0].stTime),e.getFullYear()+"/"+le(e.getMonth()+1)+"/"+le(e.getDate())},elapsedTime:function(){var e="00:00:00";if(this.audioItems.length>0){var t=this.audioItems[0].stTime,n=new Date,i=n.getTime()-t.getTime(),o=Math.floor(i/36e5),a=Math.floor(i/6e4-60*o),r=Math.floor(i/1e3-60*o*60-60*a);e=le(o)+":"+le(a)+":"+le(r)}return e},correctRatio:function(){if(this.audioItems.length>0){var e=this.audioItems.filter((function(e){return e.correctflg}));return e?e.length/this.audioItems.length*100:0}return 0}},mounted:function(){this.connectWebsocket(),this.connectLocalAudio(),this.connectRecieveAudio();var e=this;window.addEventListener("keydown",(function(t){t.repeat||"Insert"!==t.key||(e.vcmdMode=!0)})),window.addEventListener("keyup",(function(t){"Insert"===t.key&&(e.vcmdMode=!1)}))},destroyed:function(){this.disconectDevice()},methods:{resetData:function(){oe=[],ae=[],this.audioItems=[],this.selectedAudioItems=[],this.localAudioWriting=!1,this.recieveAudioWriting=!1,this.vcmdMode=!1,this.vcmd="",this.vcmdMsg=""},disconectDevice:function(){q&&q.disconnect(),J&&J.disconnect(),K&&K.stopContinuousRecognitionAsync(),X&&X.stopContinuousRecognitionAsync(),G&&G.disconnect(),Z&&Z.disconnect()},writeText:function(e,t){if(t)if(this.localAudioWriting){var n=this.audioItems.map((function(e){return e.localflg})).lastIndexOf(t);this.audioItems[n].jaText=e}else this.audioItems.push({jaText:e,enText:"",localflg:t,stTime:new Date,finTime:null,correctflg:!0}),this.localAudioWriting=!0;else if(this.recieveAudioWriting){var i=this.audioItems.map((function(e){return e.localflg})).lastIndexOf(t);this.audioItems[i].jaText=e}else this.audioItems.push({jaText:e,enText:"",localflg:t,stTime:new Date,finTime:null,correctflg:!0}),this.recieveAudioWriting=!0},confirmText:function(e,t){var n=this.audioItems.map((function(e){return e.localflg})).lastIndexOf(t);this.audioItems[n].jaText=e,this.audioItems[n].finTime=new Date,this.translator(e,n),t?this.localAudioWriting=!1:this.recieveAudioWriting=!1,this.scroll()},onRowSelected:function(e){this.selectedAudioItems=e},connectWebsocket:function(){var e=Date.now();ee=new WebSocket("ws://"+se+"/ws/"+e),ee.onmessage=function(e){JSON.parse(e.data)}},connectLocalAudio:function(){var e=this,t={audio:!0,video:!1};navigator.mediaDevices.getUserMedia(t).then((function(t){e.startRecording(t.clone());var n=m["a"].fromStreamInput(t);K=new g["a"](H,n),e.setRecognizerOption(K,!0),K.startContinuousRecognitionAsync()})).catch((function(e){console.error("mediaDevice.getUserMedia() error:",e)}))},connectRecieveAudio:function(){var e=this,t={audio:!0,video:!0};navigator.mediaDevices.getDisplayMedia(t).then((function(t){e.startRecordingRecieve(t.clone());var n=m["a"].fromStreamInput(t);X=new g["a"](H,n),e.setRecognizerOption(X,!1),X.startContinuousRecognitionAsync()})).catch((function(t){console.error("mediaDevice.getUserMedia() error:",t),alert("音声共有を許可した上で、全画面共有してください"),e.connectRecieveAudio()}))},translator:function(e,t){var n=this;b()({baseURL:ne,url:"/translate",method:"post",headers:{"Ocp-Apim-Subscription-Key":te,"Ocp-Apim-Subscription-Region":ie,"Content-type":"application/json","X-ClientTraceId":Object(y["v4"])().toString()},params:{"api-version":"3.0",from:"ja",to:"en"},data:[{text:e}],responseType:"json"}).then((function(e){var i=e.data[0].translations[0].text;n.audioItems[t]&&(n.audioItems[t].enText=i)}))},startRecording:function(e){oe=[];var t=new AudioContext({sampleRate:ce}),n=t.createScriptProcessor(re,1,1);G=t.createMediaStreamSource(e),G.connect(n),n.onaudioprocess=function(e){0==oe.length&&(Y=new Date);for(var t=e.inputBuffer.getChannelData(0),n=new Float32Array(re),i=0;i<re;i++)n[i]=t[i];oe.push(n),ee.send(t.buffer)},n.connect(t.destination)},startRecordingRecieve:function(e){ae=[];var t=new AudioContext({sampleRate:ce}),n=t.createScriptProcessor(re,1,1);Z=t.createMediaStreamSource(e),Z.connect(n),n.onaudioprocess=function(e){0==oe.length&&(Q=new Date);for(var t=e.inputBuffer.getChannelData(0),n=new Float32Array(re),i=0;i<re;i++)n[i]=t[i];ae.push(n)},n.connect(t.destination)},downloadRecording:function(e,t,n,i){var o=document.getElementById("download"),a=this.createWAV(e,t,n),r=window.URL||window.webkitURL;o.href=r.createObjectURL(a),o.download=i?i+".wav":"audio.wav",o.click()},createWAV:function(e,t,n){var i=this.cutSamples(this.mergeBuffers(e),t,n),o=this.encodeWAV(i,ce),a=new Blob([o],{type:"audio/wav"});return a},drawWave:function(e,t,n){var i=t.getContext("2d"),o=new AudioContext,a=o.createAnalyser();function r(){if(i){var e=t.width/a.fftSize,n=new Uint8Array(a.fftSize);a.getByteTimeDomainData(n),i.fillStyle="rgba(0, 0, 0, 1)",i.fillRect(0,0,t.width,t.height);for(var o=0;o<a.fftSize;++o){var c=n[o],s=c/255,l=t.height*s,d=t.height-l;i.fillStyle="lime",i.fillRect(o*e,d,e,2)}requestAnimationFrame(r)}}a.fftSize=2048,n?(q=o.createMediaStreamSource(e),q.connect(a)):(J=o.createMediaStreamSource(e),J.connect(a)),r()},csvDownload:function(){if(!(this.audioItems.length<1)){var e=new Uint8Array([239,187,191]),t="",n=Object.keys(this.audioItems[0]);t+=n.join(","),this.audioItems.forEach((function(e){t+="\r\n";var i,o=[],a=Object($["a"])(n);try{for(a.s();!(i=a.n()).done;){var r=i.value;o.push(e[r])}}catch(c){a.e(c)}finally{a.f()}t+=o.join(",")}));var i=new Blob([e,t],{type:"text/csv"}),o=document.getElementById("download");o.href=window.URL.createObjectURL(i);var a=new Date;o.download="全文_"+le(a.getMonth()+1)+le(a.getDate())+le(a.getHours())+le(a.getMinutes())+".csv",o.click()}},audioDownload:function(){var e=this;this.selectedAudioItems.length<1?this.vcmdMsg="列が選択されていません":this.selectedAudioItems.forEach((function(t){var n=t.localflg,i=n?oe:ae,o=n?Y:Q,a=t.stTime,r=t.finTime,c=a.getTime()-o.getTime(),s=Math.floor(c/1e3)-1,l=r.getTime()-o.getTime(),d=Math.ceil(l/1e3)+1,u=s+"-"+d;e.downloadRecording(i,s,d,u)}))},setRecognizerOption:function(e,t){var n=this;e.recognizing=function(e,i){console.log(i.result.text),n.vcmdMode||n.writeText(i.result.text,t)},e.recognized=function(e,i){if(console.log(i.result.text),i.result.reason==p["a"].RecognizedSpeech){if(n.vcmdMode||n.confirmText(i.result.text,t),n.vcmdMode){var o=i.result.text.toLowerCase();if(console.log("コマンド:"+o),o.indexOf("ホーム")>-1)n.vcmd="ホーム",window.location.href="/";else if(o.indexOf("リセット")>-1)n.vcmd="リセット",n.resetData();else if(o.indexOf("csvダウンロード")>-1)n.vcmd="csvダウンロード",n.csvDownload();else if(o.indexOf("音声ダウンロード")>-1)n.vcmd="音声ダウンロード",n.audioDownload();else{var a="コマンドがありません："+o;n.vcmdMsg=a}}}else i.result.reason==p["a"].NoMatch&&console.log("NOMATCH: Speech could not be recognized.")},e.canceled=function(t,n){console.log("CANCELED: Reason=".concat(n.reason)),e.stopContinuousRecognitionAsync()},e.sessionStopped=function(t,n){console.log("\n    Session stopped event."),e.stopContinuousRecognitionAsync()}},encodeWAV:function(e,t){var n=new ArrayBuffer(44+2*e.length),i=new DataView(n),o=function(e,t,n){for(var i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))},a=function(e,t,n){for(var i=0;i<n.length;i++,t+=2){var o=Math.max(-1,Math.min(1,n[i]));e.setInt16(t,o<0?32768*o:32767*o,!0)}};return o(i,0,"RIFF"),i.setUint32(4,32+2*e.length,!0),o(i,8,"WAVE"),o(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,1,!0),i.setUint32(24,t,!0),i.setUint32(28,2*t,!0),i.setUint16(32,2,!0),i.setUint16(34,16,!0),o(i,36,"data"),i.setUint32(40,2*e.length,!0),a(i,44,e),i},mergeBuffers:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].length;for(var i=new Float32Array(t),o=0,a=0;a<e.length;a++)for(var r=0;r<e[a].length;r++)i[o]=e[a][r],o++;return i},cutSamples:function(e,t,n){if(!t||!n)return e;var i=0;t=t-i>0?t-i:0,n=n-i>0?n-i:n-t;var o=t*ce,a=n*ce,r=e.slice(o,a);if(0==r.length)throw"Error: samples lengh is 0";return r},scroll:function(){var e=this.$el.querySelector(".b-table-sticky-header");e.scrollTop=e.scrollHeight}}},ue=de,fe=(n("e012"),Object(c["a"])(ue,P,V,!1,null,"8df0c94a",null)),he=fe.exports;i["default"].use(u["a"]);var ve=[{path:"/",name:"experiments",component:B},{path:"/dev",name:"dev",component:he}],me=new u["a"]({mode:"history",base:"/",routes:ve}),ge=me,pe=n("b1e0");i["default"].use(pe["a"]),i["default"].config.productionTip=!1,new i["default"]({router:ge,render:function(e){return e(d)}}).$mount("#app")},e012:function(e,t,n){"use strict";n("7156")},e86d:function(e,t,n){}});
//# sourceMappingURL=app.80b13f48.js.map